
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net Worth Tracker - Personal Financial Dashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Embedded Tailwind Configuration and Custom Styles */
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --primary: 210 100% 50%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96.1%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 222.2 84% 4.9%;
            --radius: 0.5rem;
            --success: 142 76% 36%;
            --success-foreground: 355 7% 97%;
            --warning: 38 92% 50%;
            --warning-foreground: 48 96% 89%;
            --profit: 142 69% 58%;
            --loss: 0 84% 60%;
            --neutral: 215 28% 17%;
        }

        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --popover: 222.2 84% 4.9%;
            --popover-foreground: 210 40% 98%;
            --primary: 217.2 91.2% 59.8%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 212.7 26.8% 83.9%;
            --success: 142 76% 46%;
            --success-foreground: 355 7% 97%;
            --warning: 38 92% 60%;
            --warning-foreground: 48 96% 89%;
            --profit: 142 69% 68%;
            --loss: 0 84% 70%;
            --neutral: 215 28% 77%;
        }

        body {
            min-height: 100vh;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        body.dark {
            background: linear-gradient(135deg, hsl(var(--background)) 0%, hsl(222.2 84% 3.9%) 100%);
        }

        body:not(.dark) {
            background: linear-gradient(135deg, rgba(248, 250, 252, 1) 0%, rgba(239, 246, 255, 1) 100%);
        }

        .gradient-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(147, 51, 234, 0.05) 100%);
        }

        .dark .gradient-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 51, 234, 0.1) 100%);
        }

        .gradient-success {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%);
        }

        .dark .gradient-success {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(59, 130, 246, 0.15) 100%);
        }

        .gradient-warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(239, 68, 68, 0.1) 100%);
        }

        .dark .gradient-warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(239, 68, 68, 0.15) 100%);
        }

        /* Component Styles */
        .card {
            background-color: hsl(var(--card));
            color: hsl(var(--card-foreground));
            border-radius: calc(var(--radius) - 2px);
            border: 1px solid hsl(var(--border));
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: calc(var(--radius) - 2px);
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            padding: 0.5rem 1rem;
        }

        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .btn-primary:hover {
            background-color: hsl(var(--primary) / 0.9);
        }

        .btn-outline {
            border: 1px solid hsl(var(--border));
            background-color: transparent;
            color: hsl(var(--foreground));
        }

        .btn-outline:hover {
            background-color: hsl(var(--accent));
            color: hsl(var(--accent-foreground));
        }

        .input {
            display: flex;
            height: 2.25rem;
            width: 100%;
            border-radius: calc(var(--radius) - 2px);
            border: 1px solid hsl(var(--input));
            background-color: transparent;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            color: hsl(var(--foreground));
        }

        .input:focus {
            outline: 2px solid hsl(var(--ring));
            outline-offset: 2px;
        }

        .modal {
            position: fixed;
            inset: 0;
            z-index: 50;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: hsl(var(--background));
            padding: 1.5rem;
            border-radius: calc(var(--radius));
            max-width: 28rem;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .progress {
            height: 0.5rem;
            width: 100%;
            overflow: hidden;
            border-radius: 9999px;
            background-color: hsl(var(--secondary));
        }

        .progress-bar {
            height: 100%;
            background-color: hsl(var(--primary));
            transition: width 0.3s ease;
        }

        .toggle {
            position: relative;
            display: inline-flex;
            height: 1.5rem;
            width: 2.75rem;
            cursor: pointer;
            border-radius: 9999px;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .toggle.active {
            background-color: hsl(var(--primary));
        }

        .toggle:not(.active) {
            background-color: hsl(var(--input));
        }

        .toggle-thumb {
            pointer-events: none;
            display: block;
            height: 1.25rem;
            width: 1.25rem;
            border-radius: 9999px;
            background-color: hsl(var(--background));
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }

        .toggle.active .toggle-thumb {
            transform: translateX(1.25rem);
        }

        /* Icons */
        .icon {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            fill: currentColor;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Storage utilities
        const STORAGE_KEYS = {
            ACCOUNTS: 'networth_accounts',
            GOALS: 'networth_goals',
            SETTINGS: 'networth_settings',
            DARK_MODE: 'networth_dark_mode'
        };

        const storageUtils = {
            getAccounts() {
                try {
                    const data = localStorage.getItem(STORAGE_KEYS.ACCOUNTS);
                    return data ? JSON.parse(data) : [];
                } catch (error) {
                    console.error('Error loading accounts:', error);
                    return [];
                }
            },

            saveAccounts(accounts) {
                try {
                    localStorage.setItem(STORAGE_KEYS.ACCOUNTS, JSON.stringify(accounts));
                    console.log('Accounts saved successfully');
                } catch (error) {
                    console.error('Error saving accounts:', error);
                }
            },

            addAccount(account) {
                const accounts = this.getAccounts();
                accounts.push(account);
                this.saveAccounts(accounts);
            },

            updateAccount(accountId, updates) {
                const accounts = this.getAccounts();
                const index = accounts.findIndex(acc => acc.id === accountId);
                if (index !== -1) {
                    accounts[index] = { ...accounts[index], ...updates, updatedAt: new Date().toISOString() };
                    this.saveAccounts(accounts);
                }
            },

            deleteAccount(accountId) {
                const accounts = this.getAccounts().filter(acc => acc.id !== accountId);
                this.saveAccounts(accounts);
            },

            getGoals() {
                try {
                    const data = localStorage.getItem(STORAGE_KEYS.GOALS);
                    return data ? JSON.parse(data) : [];
                } catch (error) {
                    console.error('Error loading goals:', error);
                    return [];
                }
            },

            saveGoals(goals) {
                try {
                    localStorage.setItem(STORAGE_KEYS.GOALS, JSON.stringify(goals));
                    console.log('Goals saved successfully');
                } catch (error) {
                    console.error('Error saving goals:', error);
                }
            },

            addGoal(goal) {
                const goals = this.getGoals();
                goals.push(goal);
                this.saveGoals(goals);
            },

            updateGoal(goalId, updates) {
                const goals = this.getGoals();
                const index = goals.findIndex(goal => goal.id === goalId);
                if (index !== -1) {
                    goals[index] = { ...goals[index], ...updates, updatedAt: new Date().toISOString() };
                    this.saveGoals(goals);
                }
            },

            deleteGoal(goalId) {
                const goals = this.getGoals().filter(goal => goal.id !== goalId);
                this.saveGoals(goals);
            },

            getSettings() {
                try {
                    const data = localStorage.getItem(STORAGE_KEYS.SETTINGS);
                    return data ? JSON.parse(data) : {
                        currency: 'USD',
                        currencySymbol: '$',
                        locale: 'en-US'
                    };
                } catch (error) {
                    console.error('Error loading settings:', error);
                    return {
                        currency: 'USD',
                        currencySymbol: '$',
                        locale: 'en-US'
                    };
                }
            },

            saveSettings(settings) {
                try {
                    localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(settings));
                    console.log('Settings saved successfully');
                } catch (error) {
                    console.error('Error saving settings:', error);
                }
            },

            getDarkMode() {
                try {
                    const data = localStorage.getItem(STORAGE_KEYS.DARK_MODE);
                    return data ? JSON.parse(data) : false;
                } catch (error) {
                    return false;
                }
            },

            saveDarkMode(darkMode) {
                try {
                    localStorage.setItem(STORAGE_KEYS.DARK_MODE, JSON.stringify(darkMode));
                } catch (error) {
                    console.error('Error saving dark mode:', error);
                }
            }
        };

        // Utility functions
        const formatCurrency = (amount) => {
            const settings = storageUtils.getSettings();
            return new Intl.NumberFormat(settings.locale, {
                style: 'currency',
                currency: settings.currency,
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
            }).format(amount);
        };

        const calculateNetWorth = (accounts) => {
            const assets = accounts.filter(acc => acc.isAsset);
            const liabilities = accounts.filter(acc => !acc.isAsset);
            
            const totalAssets = assets.reduce((sum, acc) => sum + acc.balance, 0);
            const totalLiabilities = liabilities.reduce((sum, acc) => sum + acc.balance, 0);
            const netWorth = totalAssets - totalLiabilities;

            return {
                totalAssets,
                totalLiabilities,
                netWorth,
                monthlyChange: 0,
                changePercentage: 0,
            };
        };

        const generateId = () => {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        };

        const getAccountCategories = () => ({
            assets: [
                { value: 'checking', label: 'Checking Account' },
                { value: 'savings', label: 'Savings Account' },
                { value: 'investment', label: 'Investment Account' },
                { value: 'retirement', label: 'Retirement Account (401k, IRA)' },
                { value: 'property', label: 'Real Estate' },
                { value: 'vehicle', label: 'Vehicle' },
                { value: 'crypto', label: 'Cryptocurrency' },
                { value: 'other', label: 'Other Asset' },
            ],
            liabilities: [
                { value: 'credit_card', label: 'Credit Card' },
                { value: 'loan', label: 'Personal Loan' },
                { value: 'mortgage', label: 'Mortgage' },
                { value: 'other', label: 'Other Debt' },
            ],
        });

        const getAccountTypeLabel = (type) => {
            const labels = {
                checking: 'Checking Account',
                savings: 'Savings Account',
                investment: 'Investment Account',
                retirement: 'Retirement Account',
                property: 'Real Estate',
                vehicle: 'Vehicle',
                crypto: 'Cryptocurrency',
                credit_card: 'Credit Card',
                loan: 'Loan',
                mortgage: 'Mortgage',
                other: 'Other',
            };
            return labels[type] || type;
        };

        // Icon components
        const PlusIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <path d="M12 5v14m-7-7h14" />
            </svg>
        );

        const MoonIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
            </svg>
        );

        const SunIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="5"/>
                <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
        );

        const TargetIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="6"/>
                <circle cx="12" cy="12" r="2"/>
            </svg>
        );

        const TrendingUpIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <polyline points="22,7 13.5,15.5 8.5,10.5 2,17"/>
                <polyline points="16,7 22,7 22,13"/>
            </svg>
        );

        const EditIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
        );

        const TrashIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <polyline points="3,6 5,6 21,6"/>
                <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"/>
            </svg>
        );

        const BuildingIcon = () => (
            <svg className="icon" fill="none" viewBox="0 0 24 24">
                <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/>
                <path d="M6 12H4a2 2 0 0 0-2 2v8h20v-8a2 2 0 0 0-2-2h-2"/>
                <path d="M10 6h4"/>
                <path d="M10 10h4"/>
                <path d="M10 14h4"/>
                <path d="M10 18h4"/>
            </svg>
        );

        // Modal component
        const Modal = ({ isOpen, onClose, children }) => {
            if (!isOpen) return null;

            return (
                <div className="modal" onClick={onClose}>
                    <div className="modal-content" onClick={e => e.stopPropagation()}>
                        {children}
                    </div>
                </div>
            );
        };

        // Add Account Modal
        const AddAccountModal = ({ isOpen, onClose, onAccountAdded }) => {
            const [formData, setFormData] = useState({
                name: '',
                type: '',
                balance: '',
                isAsset: true,
            });

            const accountCategories = getAccountCategories();

            const handleSubmit = (e) => {
                e.preventDefault();
                
                if (!formData.name || !formData.type || !formData.balance) {
                    return;
                }

                const account = {
                    id: generateId(),
                    name: formData.name,
                    type: formData.type,
                    balance: parseFloat(formData.balance),
                    isAsset: formData.isAsset,
                    category: formData.type,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                };

                storageUtils.addAccount(account);
                onAccountAdded();
                
                setFormData({
                    name: '',
                    type: '',
                    balance: '',
                    isAsset: true,
                });
                onClose();
            };

            const categories = formData.isAsset ? accountCategories.assets : accountCategories.liabilities;

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <h2 className="text-xl font-bold mb-4">Add New Account</h2>
                    
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-2">Account Type</label>
                            <div className="flex space-x-2 mb-2">
                                <button
                                    type="button"
                                    className={`btn ${formData.isAsset ? 'btn-primary' : 'btn-outline'}`}
                                    onClick={() => setFormData(prev => ({ ...prev, isAsset: true, type: '' }))}
                                >
                                    Asset
                                </button>
                                <button
                                    type="button"
                                    className={`btn ${!formData.isAsset ? 'btn-primary' : 'btn-outline'}`}
                                    onClick={() => setFormData(prev => ({ ...prev, isAsset: false, type: '' }))}
                                >
                                    Liability
                                </button>
                            </div>
                            <select
                                className="input"
                                value={formData.type}
                                onChange={(e) => setFormData(prev => ({ ...prev, type: e.target.value }))}
                                required
                            >
                                <option value="">Select account type</option>
                                {categories.map((category) => (
                                    <option key={category.value} value={category.value}>
                                        {category.label}
                                    </option>
                                ))}
                            </select>
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Account Name</label>
                            <input
                                className="input"
                                type="text"
                                placeholder="e.g., Chase Checking, Vanguard 401k"
                                value={formData.name}
                                onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
                                required
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Current Balance</label>
                            <input
                                className="input"
                                type="number"
                                step="0.01"
                                placeholder="0.00"
                                value={formData.balance}
                                onChange={(e) => setFormData(prev => ({ ...prev, balance: e.target.value }))}
                                required
                            />
                        </div>

                        <div className="flex space-x-2 pt-4">
                            <button type="button" className="btn btn-outline flex-1" onClick={onClose}>
                                Cancel
                            </button>
                            <button type="submit" className="btn btn-primary flex-1">
                                Add Account
                            </button>
                        </div>
                    </form>
                </Modal>
            );
        };

        // Add Goal Modal
        const AddGoalModal = ({ isOpen, onClose, onGoalAdded, currentNetWorth }) => {
            const [formData, setFormData] = useState({
                name: '',
                targetAmount: '',
                currentAmount: '',
                targetDate: '',
                category: '',
                description: '',
            });
            const [useNetWorth, setUseNetWorth] = useState(false);

            const goalCategories = [
                { value: 'retirement', label: 'Retirement' },
                { value: 'emergency_fund', label: 'Emergency Fund' },
                { value: 'house', label: 'House/Property' },
                { value: 'vacation', label: 'Vacation' },
                { value: 'debt_payoff', label: 'Debt Payoff' },
                { value: 'other', label: 'Other' },
            ];

            const handleSubmit = (e) => {
                e.preventDefault();
                
                if (!formData.name || !formData.targetAmount || !formData.targetDate || !formData.category) {
                    return;
                }

                const currentAmount = useNetWorth ? currentNetWorth : parseFloat(formData.currentAmount) || 0;

                const goal = {
                    id: generateId(),
                    name: formData.name,
                    targetAmount: parseFloat(formData.targetAmount),
                    currentAmount: currentAmount,
                    targetDate: formData.targetDate,
                    category: formData.category,
                    description: formData.description,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                };

                storageUtils.addGoal(goal);
                onGoalAdded();
                
                setFormData({
                    name: '',
                    targetAmount: '',
                    currentAmount: '',
                    targetDate: '',
                    category: '',
                    description: '',
                });
                setUseNetWorth(false);
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <h2 className="text-xl font-bold mb-4">Add New Goal</h2>
                    
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-2">Goal Name</label>
                            <input
                                className="input"
                                type="text"
                                placeholder="e.g., Emergency Fund, Retirement"
                                value={formData.name}
                                onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
                                required
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Category</label>
                            <select
                                className="input"
                                value={formData.category}
                                onChange={(e) => setFormData(prev => ({ ...prev, category: e.target.value }))}
                                required
                            >
                                <option value="">Select category</option>
                                {goalCategories.map((category) => (
                                    <option key={category.value} value={category.value}>
                                        {category.label}
                                    </option>
                                ))}
                            </select>
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Target Amount</label>
                            <input
                                className="input"
                                type="number"
                                step="0.01"
                                placeholder="10000"
                                value={formData.targetAmount}
                                onChange={(e) => setFormData(prev => ({ ...prev, targetAmount: e.target.value }))}
                                required
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Starting Amount</label>
                            <div className="space-y-3">
                                <div className="flex items-center space-x-3 p-3 rounded-lg border">
                                    <input
                                        type="checkbox"
                                        checked={useNetWorth}
                                        onChange={(e) => setUseNetWorth(e.target.checked)}
                                        id="use-net-worth"
                                    />
                                    <label htmlFor="use-net-worth" className="text-sm font-medium cursor-pointer">
                                        Use Current Net Worth ({formatCurrency(currentNetWorth)})
                                    </label>
                                </div>
                                
                                {!useNetWorth && (
                                    <input
                                        className="input"
                                        type="number"
                                        step="0.01"
                                        placeholder="0"
                                        value={formData.currentAmount}
                                        onChange={(e) => setFormData(prev => ({ ...prev, currentAmount: e.target.value }))}
                                    />
                                )}
                            </div>
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Target Date</label>
                            <input
                                className="input"
                                type="date"
                                value={formData.targetDate}
                                onChange={(e) => setFormData(prev => ({ ...prev, targetDate: e.target.value }))}
                                required
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium mb-2">Description (Optional)</label>
                            <textarea
                                className="input"
                                placeholder="Additional notes about this goal..."
                                value={formData.description}
                                onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}
                                rows="3"
                            />
                        </div>

                        <div className="flex space-x-2 pt-4">
                            <button type="button" className="btn btn-outline flex-1" onClick={onClose}>
                                Cancel
                            </button>
                            <button type="submit" className="btn btn-primary flex-1">
                                Add Goal
                            </button>
                        </div>
                    </form>
                </Modal>
            );
        };

        // Settings Modal
        const SettingsModal = ({ isOpen, onClose, onSettingsUpdated }) => {
            const [settings, setSettings] = useState(storageUtils.getSettings());

            const currencies = [
                { code: 'USD', symbol: '$', name: 'US Dollar' },
                { code: 'EUR', symbol: '€', name: 'Euro' },
                { code: 'GBP', symbol: '£', name: 'British Pound' },
                { code: 'JPY', symbol: '¥', name: 'Japanese Yen' },
                { code: 'CAD', symbol: 'C$', name: 'Canadian Dollar' },
                { code: 'AUD', symbol: 'A$', name: 'Australian Dollar' },
            ];

            const handleSubmit = (e) => {
                e.preventDefault();
                storageUtils.saveSettings(settings);
                onSettingsUpdated();
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <h2 className="text-xl font-bold mb-4">Settings</h2>
                    
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-2">Currency</label>
                            <select
                                className="input"
                                value={settings.currency}
                                onChange={(e) => {
                                    const currency = currencies.find(c => c.code === e.target.value);
                                    setSettings(prev => ({
                                        ...prev,
                                        currency: currency.code,
                                        currencySymbol: currency.symbol,
                                        locale: currency.code === 'USD' ? 'en-US' : 
                                               currency.code === 'EUR' ? 'de-DE' :
                                               currency.code === 'GBP' ? 'en-GB' :
                                               currency.code === 'JPY' ? 'ja-JP' :
                                               currency.code === 'CAD' ? 'en-CA' :
                                               currency.code === 'AUD' ? 'en-AU' : 'en-US'
                                    }));
                                }}
                            >
                                {currencies.map((currency) => (
                                    <option key={currency.code} value={currency.code}>
                                        {currency.symbol} {currency.name}
                                    </option>
                                ))}
                            </select>
                        </div>

                        <div className="flex space-x-2 pt-4">
                            <button type="button" className="btn btn-outline flex-1" onClick={onClose}>
                                Cancel
                            </button>
                            <button type="submit" className="btn btn-primary flex-1">
                                Save Settings
                            </button>
                        </div>
                    </form>
                </Modal>
            );
        };

        // Progress component
        const Progress = ({ value, className = "" }) => (
            <div className={`progress ${className}`}>
                <div 
                    className="progress-bar" 
                    style={{ width: `${Math.min(Math.max(value, 0), 100)}%` }}
                />
            </div>
        );

        // Main App Component
        const NetWorthTracker = () => {
            const [accounts, setAccounts] = useState([]);
            const [goals, setGoals] = useState([]);
            const [settings, setSettings] = useState(storageUtils.getSettings());
            const [loading, setLoading] = useState(true);
            const [darkMode, setDarkMode] = useState(storageUtils.getDarkMode());
            
            // Modal states
            const [showAddAccountModal, setShowAddAccountModal] = useState(false);
            const [showAddGoalModal, setShowAddGoalModal] = useState(false);
            const [showSettingsModal, setShowSettingsModal] = useState(false);

            useEffect(() => {
                loadData();
            }, []);

            useEffect(() => {
                storageUtils.saveDarkMode(darkMode);
                if (darkMode) {
                    document.body.classList.add('dark');
                } else {
                    document.body.classList.remove('dark');
                }
            }, [darkMode]);

            const loadData = () => {
                setLoading(true);
                try {
                    const loadedAccounts = storageUtils.getAccounts();
                    const loadedGoals = storageUtils.getGoals();
                    const loadedSettings = storageUtils.getSettings();
                    setAccounts(loadedAccounts);
                    setGoals(loadedGoals);
                    setSettings(loadedSettings);
                } catch (error) {
                    console.error('Error loading data:', error);
                } finally {
                    setLoading(false);
                }
            };

            const handleAccountAdded = () => {
                loadData();
            };

            const handleGoalAdded = () => {
                loadData();
            };

            const handleSettingsUpdated = () => {
                loadData();
            };

            const handleDeleteAccount = (accountId) => {
                storageUtils.deleteAccount(accountId);
                loadData();
            };

            const summary = calculateNetWorth(accounts);
            const hasData = accounts.length > 0;

            const formatTimeRemaining = (targetDate) => {
                const now = new Date();
                const target = new Date(targetDate);
                const diffTime = target.getTime() - now.getTime();
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays <= 0) return "Target date passed";
                if (diffDays < 30) return `${diffDays} days`;
                if (diffDays < 365) return `${Math.floor(diffDays / 30)} months`;
                return `${Math.floor(diffDays / 365)} years`;
            };

            const calculateProgress = (goal) => {
                return Math.min((goal.currentAmount / goal.targetAmount) * 100, 100);
            };

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"></div>
                            <p className="text-gray-600">Loading your financial data...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen">
                    <div className="container mx-auto px-4 py-8 max-w-6xl">
                        {/* Header */}
                        <div className="flex justify-between items-start mb-8">
                            <div className="text-center flex-1">
                                <h1 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4">
                                    Net Worth Tracker
                                </h1>
                                <p className="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
                                    Track your financial progress with complete privacy. All data stays on your device.
                                </p>
                            </div>
                            <div className="flex items-center gap-2 ml-4">
                                <button
                                    className={`toggle ${darkMode ? 'active' : ''}`}
                                    onClick={() => setDarkMode(!darkMode)}
                                    title="Toggle dark mode"
                                >
                                    <span className="toggle-thumb">
                                        {darkMode ? <SunIcon /> : <MoonIcon />}
                                    </span>
                                </button>
                                <button
                                    className="btn btn-outline"
                                    onClick={() => setShowSettingsModal(true)}
                                    title="Settings"
                                >
                                    {settings.currencySymbol}
                                </button>
                            </div>
                        </div>

                        {/* Privacy Banner */}
                        <div className="mb-8 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
                            <div className="flex items-center justify-center space-x-2">
                                <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                                <span className="text-green-800 dark:text-green-200 font-medium">
                                    🔒 All your data is stored locally on your device - completely private and secure
                                </span>
                            </div>
                        </div>

                        {/* Main Content */}
                        {!hasData ? (
                            // Onboarding for new users
                            <div className="text-center py-16">
                                <div className="max-w-md mx-auto">
                                    <div className="bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6">
                                        <span className="text-4xl">📊</span>
                                    </div>
                                    <h2 className="text-2xl font-bold mb-4">Welcome to Your Financial Journey</h2>
                                    <p className="text-gray-600 dark:text-gray-400 mb-8">
                                        Start by adding your first account to begin tracking your net worth and financial goals.
                                    </p>
                                    
                                    <button 
                                        onClick={() => setShowAddAccountModal(true)}
                                        className="btn btn-primary mb-8 text-lg px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg transform hover:scale-105 transition-all duration-200"
                                        style={{ height: 'auto' }}
                                    >
                                        <PlusIcon />
                                        <span className="ml-2">Start Tracking</span>
                                    </button>

                                    <div className="space-y-4">
                                        <div className="p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-100 dark:border-green-800">
                                            <h3 className="font-semibold text-green-700 dark:text-green-400 mb-2">Step 1: Add Your Accounts</h3>
                                            <p className="text-sm text-gray-600 dark:text-gray-400">
                                                Add your bank accounts, investments, properties, and debts to get a complete picture.
                                            </p>
                                        </div>
                                        <div className="p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-100 dark:border-blue-800">
                                            <h3 className="font-semibold text-blue-700 dark:text-blue-400 mb-2">Step 2: Set Your Goals</h3>
                                            <p className="text-sm text-gray-600 dark:text-gray-400">
                                                Define your financial targets and track your progress over time.
                                            </p>
                                        </div>
                                        <div className="p-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg border border-purple-100 dark:border-purple-800">
                                            <h3 className="font-semibold text-purple-700 dark:text-purple-400 mb-2">Step 3: Track Progress</h3>
                                            <p className="text-sm text-gray-600 dark:text-gray-400">
                                                Update your balances regularly and watch your net worth grow.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            // Dashboard for existing users
                            <div className="space-y-12">
                                {/* Net Worth Summary */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    <div className="md:col-span-2 card gradient-card">
                                        <div className="p-6">
                                            <h3 className="text-lg font-medium text-gray-600 dark:text-gray-400 mb-3">Total Net Worth</h3>
                                            <div className="flex items-center space-x-3">
                                                <TargetIcon />
                                                <div>
                                                    <div className="text-4xl font-bold">
                                                        {formatCurrency(summary.netWorth)}
                                                    </div>
                                                    <div className="flex items-center space-x-1 text-sm text-green-600 dark:text-green-400">
                                                        <TrendingUpIcon />
                                                        <span>Track your progress over time</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="card gradient-success">
                                        <div className="p-6">
                                            <h3 className="text-lg font-medium text-gray-600 dark:text-gray-400 mb-3">Total Assets</h3>
                                            <div className="text-2xl font-bold text-green-600 dark:text-green-400">
                                                {formatCurrency(summary.totalAssets)}
                                            </div>
                                        </div>
                                    </div>

                                    <div className="card gradient-warning">
                                        <div className="p-6">
                                            <h3 className="text-lg font-medium text-gray-600 dark:text-gray-400 mb-3">Total Liabilities</h3>
                                            <div className="text-2xl font-bold text-orange-600 dark:text-orange-400">
                                                {formatCurrency(summary.totalLiabilities)}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Accounts Section */}
                                <div className="space-y-6">
                                    <div className="flex justify-between items-center">
                                        <h2 className="text-2xl font-bold">Accounts</h2>
                                        <button onClick={() => setShowAddAccountModal(true)} className="btn btn-primary">
                                            <PlusIcon />
                                            <span className="ml-2">Add Account</span>
                                        </button>
                                    </div>

                                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        {/* Assets */}
                                        <div className="card">
                                            <div className="p-6">
                                                <h3 className="text-lg font-bold text-green-600 dark:text-green-400 mb-4">Assets</h3>
                                                <div className="space-y-3">
                                                    {accounts.filter(acc => acc.isAsset).map((account) => (
                                                        <div key={account.id} className="flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 border border-green-100 dark:border-green-800">
                                                            <div className="flex items-center space-x-3">
                                                                <div className="text-green-600 dark:text-green-400">
                                                                    <BuildingIcon />
                                                                </div>
                                                                <div>
                                                                    <div className="font-medium">{account.name}</div>
                                                                    <div className="text-sm text-gray-600 dark:text-gray-400">
                                                                        {getAccountTypeLabel(account.type)}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="font-semibold text-green-600 dark:text-green-400">
                                                                    {formatCurrency(account.balance)}
                                                                </div>
                                                                <button 
                                                                    className="btn btn-outline text-red-600 hover:text-red-700 mt-1"
                                                                    onClick={() => handleDeleteAccount(account.id)}
                                                                    style={{ padding: '0.25rem', fontSize: '0.75rem' }}
                                                                >
                                                                    <TrashIcon />
                                                                </button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                    {accounts.filter(acc => acc.isAsset).length === 0 && (
                                                        <p className="text-gray-600 dark:text-gray-400 text-center py-4">No assets added yet</p>
                                                    )}
                                                </div>
                                            </div>
                                        </div>

                                        {/* Liabilities */}
                                        <div className="card">
                                            <div className="p-6">
                                                <h3 className="text-lg font-bold text-orange-600 dark:text-orange-400 mb-4">Liabilities</h3>
                                                <div className="space-y-3">
                                                    {accounts.filter(acc => !acc.isAsset).map((account) => (
                                                        <div key={account.id} className="flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 border border-orange-100 dark:border-orange-800">
                                                            <div className="flex items-center space-x-3">
                                                                <div className="text-orange-600 dark:text-orange-400">
                                                                    <BuildingIcon />
                                                                </div>
                                                                <div>
                                                                    <div className="font-medium">{account.name}</div>
                                                                    <div className="text-sm text-gray-600 dark:text-gray-400">
                                                                        {getAccountTypeLabel(account.type)}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="font-semibold text-orange-600 dark:text-orange-400">
                                                                    {formatCurrency(account.balance)}
                                                                </div>
                                                                <button 
                                                                    className="btn btn-outline text-red-600 hover:text-red-700 mt-1"
                                                                    onClick={() => handleDeleteAccount(account.id)}
                                                                    style={{ padding: '0.25rem', fontSize: '0.75rem' }}
                                                                >
                                                                    <TrashIcon />
                                                                </button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                    {accounts.filter(acc => !acc.isAsset).length === 0 && (
                                                        <p className="text-gray-600 dark:text-gray-400 text-center py-4">No liabilities added yet</p>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Goals Section */}
                                <div className="space-y-6">
                                    <div className="flex justify-between items-center">
                                        <h2 className="text-2xl font-bold">Financial Goals</h2>
                                        <button onClick={() => setShowAddGoalModal(true)} className="btn btn-outline">
                                            <PlusIcon />
                                            <span className="ml-2">Add Goal</span>
                                        </button>
                                    </div>

                                    {goals.length === 0 ? (
                                        <div className="card">
                                            <div className="p-12 text-center">
                                                <TargetIcon />
                                                <h3 className="text-lg font-semibold mb-2">No financial goals yet</h3>
                                                <p className="text-gray-600 dark:text-gray-400 mb-4">Set your first goal to start tracking your progress</p>
                                                <button onClick={() => setShowAddGoalModal(true)} className="btn btn-primary">
                                                    <PlusIcon />
                                                    <span className="ml-2">Add Your First Goal</span>
                                                </button>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            {goals.map((goal) => {
                                                const progress = calculateProgress(goal);
                                                const timeRemaining = formatTimeRemaining(goal.targetDate);

                                                return (
                                                    <div key={goal.id} className="card gradient-card">
                                                        <div className="p-6">
                                                            <div className="flex items-center justify-between mb-4">
                                                                <div className="flex items-center space-x-2">
                                                                    <TargetIcon />
                                                                    <span className="font-semibold">{goal.name}</span>
                                                                </div>
                                                            </div>
                                                            <div className="space-y-4">
                                                                <div>
                                                                    <div className="flex justify-between items-center mb-2">
                                                                        <span className="text-sm text-gray-600 dark:text-gray-400">Progress</span>
                                                                        <span className="text-sm font-medium">{progress.toFixed(1)}%</span>
                                                                    </div>
                                                                    <Progress value={progress} className="h-3" />
                                                                    <div className="flex justify-between items-center mt-2 text-sm">
                                                                        <span className="text-green-600 dark:text-green-400 font-medium">
                                                                            {formatCurrency(goal.currentAmount)}
                                                                        </span>
                                                                        <span className="text-gray-600 dark:text-gray-400">
                                                                            {formatCurrency(goal.targetAmount)}
                                                                        </span>
                                                                    </div>
                                                                </div>

                                                                <div className="pt-2 border-t border-gray-200 dark:border-gray-700">
                                                                    <div className="text-sm text-gray-600 dark:text-gray-400">
                                                                        {timeRemaining} remaining
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Modals */}
                        <AddAccountModal
                            isOpen={showAddAccountModal}
                            onClose={() => setShowAddAccountModal(false)}
                            onAccountAdded={handleAccountAdded}
                        />

                        <AddGoalModal
                            isOpen={showAddGoalModal}
                            onClose={() => setShowAddGoalModal(false)}
                            onGoalAdded={handleGoalAdded}
                            currentNetWorth={summary.netWorth}
                        />

                        <SettingsModal
                            isOpen={showSettingsModal}
                            onClose={() => setShowSettingsModal(false)}
                            onSettingsUpdated={handleSettingsUpdated}
                        />
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<NetWorthTracker />, document.getElementById('root'));
    </script>
</body>
</html>
